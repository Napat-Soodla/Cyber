import csv
import yara

def read_yara_rules_from_csv(file_path):
    rules = []
    with open(file_path, 'r', encoding='utf-8') as csv_file:
        csv_reader = csv.reader(csv_file)
        for row in csv_reader:
            if row and not row[0].startswith("#"):  # อันนี้คือตรวจสอบไม่ให้เอาหัวตารางและคอมเมนต์
                rules.append(row[0])
    return rules

# ส่วนอันนี้คือเปลี่ยนเส้นทางไฟล์ CSV เป็นที่อยู่ของไฟล์ที่ดาวน์โหลด คิดว่าคือไฟล์ที่เทอส่งมา
csv_file_path = 'download.csv'
yara_rules = read_yara_rules_from_csv(csv_file_path)

# พิมพ์ YARA rules ที่ได้
for rule in yara_rules:
    print(rule)
